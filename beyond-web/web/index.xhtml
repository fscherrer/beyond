<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./templates/template.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core">


  <ui:define name="titulo">
    <h:outputText value="#{msgs.Evento_tituloPagina}" />
  </ui:define>

  <ui:define name="conteudo">

    <h:form id="formDetalhesEvento">
      <p:dialog widgetVar="dialogDetalhesEvento"
                id="dialogDetalhesEvento"
                header="#{msgs.global_detalhes}"
                width="400">
        <h:panelGrid columns="2">
          <h:outputText value="Evento: " class="negrito"/>
          <h:outputText value="#{eventosMB.evento.nome}" />

          <h:outputText value="Bandas:" styleClass="negrito sublinhado"/>
          <p:panel styleClass="panelCru" />

          <p:panel styleClass="panelCru" />
          <p:panel styleClass="panelCru">
            <ui:repeat value="#{eventosMB.evento.bandas}" var="banda">
              <h:outputText value="#{banda.nome}" />
            </ui:repeat>
          </p:panel>

          <h:outputText value="Local: " styleClass="negrito"/>
          <h:outputText value="#{eventosMB.evento.casa.nome}" />

          <h:outputText value="Data/Hora: " styleClass="negrito"/>
          <h:outputText value="#{eventosMB.evento.datahora}">
            <f:convertDateTime pattern="dd/MM/yyyy   -   HH:mm"/>
          </h:outputText>

          <h:outputText value="Valor: " styleClass="negrito"/>
          <h:outputText value="R$ #{eventosMB.evento.valor}"/>
        </h:panelGrid>

        <p:panel styleClass="panelCru" style="text-align: center;">
          <p:commandButton value="#{msgs.global_ok}" onclick="dialogDetalhesEvento.hide()"/>
        </p:panel>
      </p:dialog>
    </h:form>

    <h:form>
      <h:panelGrid columns="1" style="width: 100%;" styleClass="panelCru">
        <h:panelGroup layout="block" style="vertical-align: middle;">
        
          <h:panelGroup layout="block" style="float: left;">
            <p:commandButton value="#{msgs.global_atualizar}" action="#{eventosMB.carregarEventos()}"
                             update="tableEventos"/>
          </h:panelGroup>
          <h:panelGroup layout="block" style="float: right; position: relative; top: 8px;">
            <h:link value="#{msgs.global_area_administrativa}" outcome="login"/>
          </h:panelGroup>
        </h:panelGroup>

        <p:dataTable id="tableEventos" var="evento" value="#{eventosMB.eventos}">
          <p:column sortBy="#{evento.nome}" headerText="#{msgs.Evento_nome}">
            <h:outputText value="#{evento.nome}" />
          </p:column>
          <p:column sortBy="#{evento.datahora}" headerText="#{msgs.Evento_dataHora}">
            <h:outputText value="#{evento.datahora}">
              <f:convertDateTime pattern="dd/MM/yyyy  -  HH:mm"/>
            </h:outputText>
          </p:column>

          <p:column sortBy="#{evento.casa.nome}" headerText="#{msgs.Evento_casa}">
            <h:outputText value="#{evento.casa.nome}" />
          </p:column>

          <p:column width="30" headerText="#{msgs.global_detalhes}">
            <p:commandButton value="Detalhes" title="Detalhes" oncomplete="dialogDetalhesEvento.show();"
                             update=":formDetalhesEvento:dialogDetalhesEvento">
              <f:setPropertyActionListener value="#{evento}" target="#{eventosMB.evento}" />
            </p:commandButton>
          </p:column>

        </p:dataTable>
      </h:panelGrid>
    </h:form>
  </ui:define>

</ui:composition>
